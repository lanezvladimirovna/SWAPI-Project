<div class="flex flex-col h-screen">
  <header class="bg-black text-white p-4 flex flex-wrap">
    <img
      class="h-10 mt-2 sm:mt-0"
      src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6c/Star_Wars_Logo.svg/320px-Star_Wars_Logo.svg.png"
    />
    <button (click)="swapiService.exportCSV()" class="mb-2 ms-auto me-1 bg-yellow-500 hover:bg-yellow-700 text-white py-2 px-4 rounded ">Export</button>
    <form class="flex flex-col sm:flex-row gap-2 flex-wrap w-full">
      <input
        (input)="onSearchInputChange($event)"
        [value]="swapiService.searchFilter()"
        class="bg-white placeholder:text-slate-400 text-slate-700 text-sm border border-slate-200 rounded-md px-3 py-2 transition duration-300 ease focus:outline-none focus:border-slate-400 hover:border-slate-300 shadow-sm flex-grow"
        placeholder="Search..."
      />
      <div class="flex gap-2 flex-wrap">
        @for(gender of swapiService.genderValues(); track gender;){
          <div [ngClass]="{
            'bg-yellow-400': swapiService.genderFilter().includes(gender),
            'bg-yellow-700': !swapiService.genderFilter().includes(gender) }"
          (click)="swapiService.toggleSelection(gender)"
          class="cursor-pointer inline-flex items-center rounded-full px-3 py-1 text-sm text-black">
            <span>{{gender}}</span>
          </div>
        }
      </div>
      <div class="flex items-center">
        <input type="checkbox" id="chip-checkbox" class="hidden peer" (click)="swapiService.toggleFavorite()" [checked]="swapiService.showFavorite()"/>
        <label for="chip-checkbox" class="flex items-center cursor-pointer bg-gray-200 text-gray-800 text-sm font-medium rounded-full py-2 px-4 shadow-md transition duration-200 ease-in-out hover:bg-gray-300 peer-checked:bg-blue-500 peer-checked:text-white peer-checked:shadow-lg">
          <span class="mr-2">Favorites</span>
          <svg class="w-4 h-4 hidden peer-checked:block" fill="currentColor" viewBox="0 0 24 24">
            <path d="M9 16.2l-4.2-4.2 1.4-1.4L9 13.4l7.8-7.8 1.4 1.4z" />
          </svg>
        </label>
      </div>
    </form>
  </header>

  <div class="flex flex-col sm:flex-row flex-grow overflow-hidden">
    
    <!-- Character Card -->
    <div class="w-full sm:w-1/2 p-4 order-1 sm:order-2">
      <character-card [character]="selectedItem"></character-card>
    </div>
    
    <!-- Character List -->
    <div class="flex-grow overflow-y-auto p-4 order-2 sm:order-1">
      <h2 class="text-xl font-semibold">Characters</h2>
      @if(isLoading){
        <div class="w-full h-5/6 flex justify-center items-center">
          <spinner></spinner>
        </div>
      }
      @else{
        <ul class="mt-2">
          @for(person of swapiService.filteredData(); track person; let index = $index){
          <li class="py-2 border-b flex flex-row justify-between items-center">
            <label class="cursor-pointer" (click)="selectItem(person)">{{ person.name }}</label>
            <input [checked]="swapiService.favoriteFilter().includes(person.name)" class="ms-auto" type="checkbox" (click)="swapiService.markAsFavorite(person.name)" />
           </li>
          }
        </ul>
      }
    </div>
  </div>
</div>
